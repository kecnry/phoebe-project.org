<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Phoebe 0.29 Tutorial - Inspecting data files closely</TITLE>
<META NAME="description" CONTENT="Inspecting data files closely">
<META NAME="keywords" CONTENT="phoebe_tutorial">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-2">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="phoebe_tutorial.css">

<LINK REL="next" HREF="component_params.html">
<LINK REL="previous" HREF="presume.html">
<LINK REL="up" HREF="first_steps.html">
<LINK REL="next" HREF="component_params.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->

<B> Next:</B> <A NAME="tex2html236"  HREF="component_params.html">Component-related parameters</A>
<B> Up:</B> <A NAME="tex2html232"  HREF="first_steps.html">First steps with PHOEBE</A>
<B> Previous:</B> <A NAME="tex2html226"  HREF="presume.html">What else may we</A>
 &nbsp; <B>  <A NAME="tex2html234"  HREF="contents.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00037000000000000000">
Inspecting data files closely</A>
</H2>

<P>
The next logical step would usually be eye inspection of light curves and radial velocity curves. <TT>PHOEBE </TT>enables you to plot experimental curves in a separate window, which you access by clicking on the <code>Plot LC</code> button on the button box for light curves and <code>Plot RV</code> button for radial velocity curves.

<P>
Let us start with light curves. Click on the <code>Plot LC</code> button on the button-box.

<P>

<DIV ALIGN="CENTER"><A NAME="phoebe_lc_plotting_window"></A><A NAME="175"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 10:</STRONG>
The light curves plotting window.</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<IMG
 ALIGN="BOTTOM" BORDER="0"
 SRC="phoebe_lc_plotting_window.png"
 ALT="phoebe lc plotting window"> 
<BR>
</DIV></TD></TR>
</TABLE>
</DIV>

<P>
The top left part of the LC plotting window (Fig. <A HREF="#phoebe_lc_plotting_window">10</A>) is used to select what it is we want plotted. Synthetic light curves are computed from theory, based on the current palette of physical parameters. Experimental light curves are taken from our input files. You may choose which experimental curve to plot by selecting its photometric filter; all <TT>PHOEBE </TT>operations are in fact identified with their filter names rather than filenames.

<P>
The resolution of a synthetic light curve is defined by the number of vertexes that we use for plotting. This value is held by an entry labelled <code>Vertexes</code>. If we have steep and narrow eclipses, we need finer resolution, especially in eclipse regions. The number of vertexes defaults to 100, but sometimes this does not suffice for accurate inspections. Try setting it to 300 for the time being.

<P>
The top right part of the LC plotting window is used to assign the variables of our plot. The independent variable is plotted on x-axis and the dependent variable is plotted on y-axis.

<P>
Independent variable may be time (HJD) or phase. If the independent variable for our plot is phase and what we have in our input files is heliocentric Julian date, then <TT>PHOEBE </TT>automatically transforms HJD to phase according to the origin of time and period that we set in the main <TT>PHOEBE </TT>window. This automatic procedure transforms all data points to have phases between <SPAN CLASS="MATH"><IMG
 WIDTH="44" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img24.png"
 ALT="$-0.5$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="29" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img25.png"
 ALT="$0.5$"></SPAN>. Thus, if we use a plotting range wider than this, the regions outside this interval will contain no data points. That is why <TT>PHOEBE </TT>allows you to <I>map</I> existing points to the whole region of the plot. This means that a single data point will occur multiple times, wherever the phase of that point is the same. This procedure is referred to as <I>aliasing</I><A NAME="tex2html18"
  HREF="footnode.html#foot182"><SUP><SPAN CLASS="arabic">8</SPAN></SUP></A>. Aliasing is turned on through a <code>Turn on data aliasing</code> switch.

<P>
Dependent variable is a bit tricky. It may be:

<UL>
<LI><code>Magnitude</code>; experimental data is plotted without any transformation if the input files contain magnitudes and is transformed with respect to the <code>Zero Magnitude</code> value from the <code>Data</code> tab to fluxes. Synthetic data is transformed internally with respect to wavelength dependent level parameters (<code>HLA</code>s and <code>CLA</code>s).
</LI>
<LI><code>Total Flux</code>; this is the most significant quantity for <TT>PHOEBE</TT>. All calculations are performed with respect to the total flux. By total flux we mean the sum of the flux from the first star, the flux from the second star and the (optional) third light. The units of total flux are arbitrary and are made physically meaningful through level parameters (<code>HLA</code>s and <code>CLA</code>s), as explained in detail in the next section. Experimental data is copied verbatim if the input files contain fluxes and is transformed with respect to the <code>Zero Magnitude</code> value from the <code>Data</code> tab, if they contain magnitudes.
</LI>
<LI><code>Primary Star Flux</code>; this is the calculated contribution of the primary star. It has no relevant counterpart in experimental data since you cannot isolate the mere contribution of the primary star, so that part of the output is suppressed.
</LI>
<LI><code>Secondary Star Flux</code>; this is the calculated contribution of the secondary star. This too has no relevant counterpart in experimental data and is thus suppressed.
</LI>
<LI><code>Normalized flux</code>; this quantity is for your convenience only. Some <code>WD</code> users prefer to adjust the shape of a light curve first and fix the curve level at the very end. This approach seems a bit vague and is deprecated in <TT>PHOEBE</TT>, but it is still available. The normalized flux is the same as the total flux, except that it is re-normalized to the value given by the <code>Flux Factor</code> (usually 1) at the phase given by <code>Norm. Phase</code> (usually 0.25).
</LI>
</UL>

<P>
Let's first see whether our period and the origin of time make sense; thus we do not want to plot synthetic light curve, so turn the button <code>Synthetic LC</code> off. The data filter is already set to <code>440nm (B)</code> in the drop-down list. Note that this list contains only filters that correspond to experimental data curves as defined in the <code>Data</code> tab. Now turn the <TT>Experimental light curve</TT> switch on. We shall plot the total flux against phase (which is the default). The phase range lets you select what phases you want plotted. This too we shall at this time leave at their current values.

<P>
To actually plot the diagram, click on the <code>Plot</code> button. The plot in Fig. <A HREF="#phoebe_lc_plotting_window_experimental_data">11</A> appears.

<P>

<DIV ALIGN="CENTER"><A NAME="phoebe_lc_plotting_window_experimental_data"></A><A NAME="190"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 11:</STRONG>
Plotted 440nm (B) light curve.</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<IMG
 ALIGN="BOTTOM" BORDER="0"
 SRC="phoebe_lc_plotting_window_experimental_data.png"
 ALT="phoebe lc plotting window experimental data"> 
<BR>
</DIV></TD></TR>
</TABLE>
</DIV>

<P>
You may see that the values for period and the origin of time are pretty much what one would expect, since the minima are at phases 0.0 and 0.5 for all times.

<P>
Whenever you click on the <code>Plot</code> button, the plot is displayed; underneath it you may find the number of experimental data points, in our case 1563. The values of weighted and unweighted <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img11.png"
 ALT="$\sigma$"></SPAN>s (<code>Sigma</code>) are calculated between experimental data and synthetic light curve, so they are not calculated now that we don't plot a synthetic lightcurve. On the right of the plot you may see the <code>Modeling</code> <code>parameters</code> part of the plotting window; these parameters are calculated from synthetic light curve parameters, so again they are not displayed for our first plot.

<P>
Now select the other light curve by choosing <code>550nm (V)</code> filter instead of <code>440nm (B)</code>.

<P>
Let us check how big is the difference between the initial synthetic light curve and experimental data! Turn on synthetic light curve (<code>Synthetic LC</code> switch) and click on <code>Plot</code> again! You are presented with the picture as it Fig. <A HREF="#phoebe_lc_plotting_window_both_data">12</A>.

<P>

<DIV ALIGN="CENTER"><A NAME="phoebe_lc_plotting_window_both_data"></A><A NAME="198"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 12:</STRONG>
Synthetic light curve with plotted 440nm (B) light curve.</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<IMG
 ALIGN="BOTTOM" BORDER="0"
 SRC="phoebe_lc_plotting_window_both_data.png"
 ALT="phoebe lc plotting window both data"> 
<BR>
</DIV></TD></TR>
</TABLE>
</DIV>

<P>
Synthetic curve is denoted with a solid red line and experimental data with blue filled circles.

<P>
As you may see, the result is disasterous. Standard deviations <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img11.png"
 ALT="$\sigma$"></SPAN> are now calculated. If individual weights are included in the computation, we obtain the value of <!-- MATH
 $\sigma_W = 0.288071$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="127" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.png"
 ALT="$\sigma_W = 0.288071$"></SPAN> and if they are not included in the computation, we obtain <!-- MATH
 $\sigma = 0.272182$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="112" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img29.png"
 ALT="$\sigma = 0.272182$"></SPAN>. It is <SPAN CLASS="MATH"><IMG
 WIDTH="31" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img30.png"
 ALT="$\sigma_W$"></SPAN> that drives our fit during the minimization scheme, more precisely a convolution of all lightcurve-dependent <SPAN CLASS="MATH"><IMG
 WIDTH="31" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img30.png"
 ALT="$\sigma_W$"></SPAN>s.

<P>
Synthetic light curve computation now supplies values to the <code>Modeling</code> <code>Parameters</code> window (on the right of the plot itself). Browse through parameters to see what is contained in the output. Abreviations <code>P</code> and <code>S</code> stand for primary and secondary star, respectively. The masses are expressed in units of solar mass, mean radii in units of solar radius. Bolometric magnitude <code>Mbol</code> is in magnitude units and surface gravity potential has standard cgs units g cm/s<SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="20" ALIGN="BOTTOM" BORDER="0"
 SRC="img31.png"
 ALT="${}^2$"></SPAN>. <code>PSB</code> stands for polar surface brightness, <code>Surface</code> is in units of the Roche lobe surface size and all radii informations are given with respect to the semi-major axis. The values you see make no sense, but this is of course to be expected, since parameter values are way wrong. Don't worry about it, they will converge eventually.

<P>
The fit between experimental points and the synthetic curve is, for the lack of a better word, terrible. Inspect the other light curve. To get the feeling of discrepancy, you may use the <code>Plot</code> <code>Residuals</code> switch in the mid-upper part of the window. This switch tells <TT>PHOEBE </TT>to calculate the residuals between synthetic and experimental light curve and to plot them against independent variable. One would hope to get a pure scatter around 0, but this of course cannot yet be the case.

<P>
Just above the plot there are plot control arrows and zooming buttons. These controls enable you to move your plot according to your needs. Try zooming in on the eclipse minimum, move the plot around and, all in all, get a feeling of the plotting window as a whole. A button in between the direction arrows is the reset button; clicking on it will restore original plot settings. On the far right of that part of the plotting window you see the grid options and the coordinate options for your plot. The grid (both coarse and fine) is used to easily read out the values from the plot directly. Some users might prefer axes to a boxed coordinate system and this option is supported too.

<P>
When you had your share of playing with the LC plotting window and have examined the results, click on the <code>Done</code> button to close the window. Note that you may keep the window open if you prefer - this is usually sound to do when your monitor resolution is very high (1600<SPAN CLASS="MATH"><IMG
 WIDTH="20" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img32.png"
 ALT="$\times$"></SPAN>1200 or so).

<P>
<BR>
<BR>
<DIV CLASS="centerline" ID="par2015" ALIGN="CENTER">
&#167;</DIV>
<BR>
<BR>

<P>
We shall now do much the same for radial velocity curves; open the RV plotting window by clicking on the <code>RV Plot</code> button on the button box.

<P>

<DIV ALIGN="CENTER"><A NAME="phoebe_rv_plotting_window"></A><A NAME="209"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 13:</STRONG>
The radial velocities plotting window.</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<IMG
 ALIGN="BOTTOM" BORDER="0"
 SRC="phoebe_rv_plotting_window.png"
 ALT="phoebe rv plotting window"> 
<BR>
</DIV></TD></TR>
</TABLE>
</DIV>

<P>
The shape and feel of the RV plotting window is much the same as the LC plotting window, although few differences should be stressed. Dependent plot variables are as follows:

<P>

<UL>
<LI><code>Primary (Secondary) RV in km/s</code>; these two variables tell <TT>PHOEBE </TT>we want our radial velocities in km/s. This is the most common choice.
</LI>
<LI><code>Both RVs in km/s</code>; same as above, just that both radial velocity curves are plotted on one plot.
</LI>
<LI><code>Primary (Secondary) Normalized RV</code>; radial velocity curves normalized to orbit, meaning they are transformed to a dimensionless value by multiplying their value in km/s with <!-- MATH
 $P_0[\mathrm{s}]/2\pi a[\mathrm{km}]$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="118" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img34.png"
 ALT="$P_0[\mathrm{s}]/2\pi a[\mathrm{km}]$"></SPAN>. Same is done with experimental data. This means that we expect the value of normalized velocity around <SPAN CLASS="MATH"><IMG
 WIDTH="29" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img25.png"
 ALT="$0.5$"></SPAN> if the mass ratio is around <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$1$"></SPAN>.
</LI>
<LI><code>Primary (Secondary) eclipse proximity corrections</code>; this shows the effects of the eclipse proximity correction on radial velocities in the same dimensionless units as explained above. Experimental data has no counterpart and its output is thus suppressed.
</LI>
</UL>

<P>
This time leave both experimental data and synthetic RV switches on; if you select the first filter (carrying #1 in its name), set <code>Primary</code> <code>Normalized</code> <code>RV</code> as the dependent variable. If you select the other RV curve, set <code>Secondary</code> <code>Normalized</code> <code>RV</code> as the dependent variable. Try plotting both radial velocity curves on on plot.

<P>

<DIV ALIGN="CENTER"><A NAME="phoebe_rv_plotting_window_with_both_plots"></A><A NAME="220"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 14:</STRONG>
Primary RV curve in km/s; the discrepancy consists of two contributions: one is the amplitude misfit (<SPAN CLASS="MATH"><IMG
 WIDTH="28" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$K_1$"></SPAN> value is wrong) and the other is vertical offset (center-of-mass <SPAN CLASS="MATH"><IMG
 WIDTH="22" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$v_\gamma$"></SPAN> velocity is wrong, although hardly noticeable).</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<IMG
 ALIGN="BOTTOM" BORDER="0"
 SRC="phoebe_rv_plotting_window_both_data.png"
 ALT="phoebe rv plotting window both data"> 
<BR>
</DIV></TD></TR>
</TABLE>
</DIV>

<P>
Feel free to examine other options of the plotting window. See what is accomplished when different choices are made. Move the plot around, turn the grid on and off, change the coordinate system shape to axes or boxes. Make your <TT>PHOEBE </TT>session as comfortable as possible. Again, if you wish, you may leave your RV plotting window open or close it by clicking on the <code>Done</code> button.

<P>
As you have seen, it doesn't make much sense to plot synthetic solution over experimental data at first. The fit is of course bad and the only thing you should really check at this early stage is that ephemerides for your binary are correct: the period (<SPAN CLASS="MATH"><IMG
 WIDTH="25" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img37.png"
 ALT="$P_0$"></SPAN>) and the the origin of time (<!-- MATH
 $\mathrm{HJD}_0$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="50" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img38.png"
 ALT="$\mathrm{HJD}_0$"></SPAN>). If your binary exhibits a period change (typically seen by smearing you cannot fix by changing <SPAN CLASS="MATH"><IMG
 WIDTH="25" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img37.png"
 ALT="$P_0$"></SPAN> or <!-- MATH
 $\mathrm{HJD}_0$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="50" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img38.png"
 ALT="$\mathrm{HJD}_0$"></SPAN>), you should set that parameter value appropriately.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->

<B> Next:</B> <A NAME="tex2html236"  HREF="component_params.html">Component-related parameters</A>
<B> Up:</B> <A NAME="tex2html232"  HREF="first_steps.html">First steps with PHOEBE</A>
<B> Previous:</B> <A NAME="tex2html226"  HREF="presume.html">What else may we</A>
 &nbsp; <B>  <A NAME="tex2html234"  HREF="contents.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
